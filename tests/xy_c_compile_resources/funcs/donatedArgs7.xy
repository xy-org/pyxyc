# test modifying a donated value with dtor

struct Array {
    ptr: Ptr~Int;
}

def get(arr: Array, idx: Int) -> arr[ Ptr~Int ] {
    return arr.ptr + idx;
}

def modifyFunc(a: don Int) {
    void =< a;
}

def modifyMacro(a: don Int) = -> void {
    void =< a;
};

def testFunc() {
    s: Array;
    modifyFunc(s[1]);
}

def testMacro1() {
    s: Array;
    modifyMacro(s[1]);
}

def testMacro2(s: Array) {
    modifyMacro(s[3]);
}

def testMacro3(s: Array) {
    modifyMacro(a=s[3]);
}