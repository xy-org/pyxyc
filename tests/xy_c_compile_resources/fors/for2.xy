;; Fibonacci number iterator
;; --------------------------

struct Fib {
    a := 0;
    b := 1;
}

func fibonacci~IterCtor() -> [ Fib ] {
    return Fib{};
}

func valid(fib: Fib) = true;

func next(fib: mut Fib) {
    fib = Fib{fib.a + fib.b, fib.a};
}

func get(fib: Fib) = fib.a;

;; Multiplies the first {lim} fibonacci numbers
func mulFibs(lim: Int) -> Int {
    return for (_ in :lim, fib in fibonacci()) -> (res := 1) { res *= fib; };
}
