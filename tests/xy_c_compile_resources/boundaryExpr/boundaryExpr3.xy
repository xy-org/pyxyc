struct Logger{
    enabled: Bool;
}

struct Msg {
    data: Long;
}

func info(log: Logger, ^msg: Msg, logged : Bool = if (log.enabled) doLog(log, ^msg) else false) {}

func doLog(log: Logger, msg: Msg) -> Bool {
    # log msg
    return true;
}

func longComputation() -> Msg {
    return Msg{};
}

func test() {
    log := Logger{};
    log \info longComputation();
}
