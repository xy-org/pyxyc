import xy.ctti;

;; Structure of Arrays
struct SoA {
    mem: Ptr;
}

struct Index {
    idx: Int;
}

func get(soa: SoA, idx: Int) -> soa[ Index, ... ] {
    return Index{idx};
}

;; We need that in order to get the correct Field object
func get(soa: Soa, idx: Index) -> soa[ Ptr~Data ] {
    return Ptr;
}

func get(
    soa: SoA, idx: Index, field: pseudo Field,
    size: Usize = field'sizeof, offset: Usize = field'offsetof
) -> soa[ Ptr~[^field..type] ] {
    return Ptr{};
}

struct Data {
    a: Int;
    b: Ulong;
}

func test1() -> Int {
    soa: SoA;
    a := soa[10].a;
    b := soa[12].b'to(Int);
    return a + b;
}
